import { ParsedPresentation, SlideTextContent } from "./types";
/**
 * PptxParser - A class for parsing PowerPoint (PPTX) files and extracting their content
 *
 * This parser can:
 * - Extract raw XML content from PPTX files
 * - Parse the XML into JavaScript objects
 * - Extract formatted text content from slides
 * - Preserve line breaks and paragraph formatting
 *
 * PPTX files are essentially ZIP archives containing XML files. The main files we care about are:
 * - presentation.xml: Contains the main presentation structure
 * - _rels/presentation.xml.rels: Contains relationships between presentation parts
 * - slides/slide*.xml: Contains individual slide content
 */
export default class PptxParser {
    private filePath;
    /**
     * Creates a new instance of PptxParser
     * @param filePath - Path to the PPTX file to be parsed
     */
    constructor(filePath: string);
    /**
     * Parses the entire PPTX file and returns its content
     *
     * This method:
     * 1. Opens the PPTX file as a ZIP archive
     * 2. Extracts and parses the presentation.xml
     * 3. Extracts and parses the relationship file
     * 4. Finds and parses all slides
     *
     * @returns Promise<ParsedPresentation> - Object containing parsed presentation data
     * @throws Error if the PPTX file is invalid or cannot be parsed
     */
    parse(): Promise<ParsedPresentation>;
    /**
     * Extracts content from a file within the PPTX archive
     *
     * @param file - A file from the unzipper library
     * @returns Promise<string> - The file's content as a string
     */
    private getFileContent;
    /**
     * Parses XML content into a JavaScript object
     *
     * @param xmlContent - Raw XML string to parse
     * @returns Promise<any> - Parsed JavaScript object
     */
    private parseXmlContent;
    /**
     * Extracts slide relations from the presentation relationships XML
     *
     * In PPTX files, slides are referenced by relationships in the presentation.xml.rels file.
     * This method finds all slide references in these relationships.
     *
     * @param relationshipsData - Parsed relationship XML data
     * @returns SlideRelation[] - Array of slide relations
     */
    private getSlideRelations;
    /**
     * Extracts formatted text content from all slides
     *
     * This is a convenience method that:
     * 1. Parses the entire presentation
     * 2. Extracts text from each slide
     * 3. Preserves formatting and line breaks
     *
     * @returns Promise<SlideTextContent[]> - Array of slide text content
     */
    extractText(): Promise<SlideTextContent[]>;
    /**
     * Extracts text content from a single slide while preserving formatting
     *
     * PowerPoint slide XML structure:
     * - p:sp: Shape elements that can contain text
     * - p:txBody: The text body within a shape
     * - a:p: Individual paragraphs
     * - a:r: Text runs within paragraphs
     * - a:t: Actual text content
     * - a:br: Line breaks
     * - a:endParaRPr: Paragraph end markers
     *
     * @param slideData - Parsed slide XML data
     * @returns string[] - Array of text blocks with preserved formatting
     */
    private extractTextFromSlide;
}
